#############
# VARIABLES #
#############
TERM=foot
FILES=pcmanfm-qt
MENU=sirula
BROWSER=firefox
WALLPAPER=/home/missu/Pictures/pexels-c√°tia-matos-1072179.jpg
ALL_TAGS=$(((1 << 32) - 1))
FLOATS=(gnome-pomodoro qalculate-gtk qalculate-qt)
#gtk-theme=''
#cursor-theme=''
#icon-theme=''
#font=''

MAP='riverctl map normal'
INPUT='riverctl input'
SPAWN='riverctl spawn'
CMD='riverctl'
ROTATE='wlr-randr --output eDP-1 --transform '
TOUCHPAD='pointer-1739-10608-SYN1B7E:01_06CB:2970_Touchpad'
KERNEL='lts'
GSET='gsettings set'
INTERFACE='org.gnome.desktop.interface'

############
# MAPPINGS #
############
$MAP Super+Shift   Return spawn "$TERM"
$MAP Control+Shift escape spawn "$TERM gotop"
$MAP Super          Space spawn "$MENU"
$MAP Super              e spawn "$FILES"
$MAP Super              b spawn "$BROWSER"
$MAP Super+Shift        m spawn "xdg-open https://mail.protonmail.com/u/0/all-mail#filter=unread"
$MAP Control+Alt+Shift Delete spawn "loginctl reboot"
$MAP Control+Alt   Delete spawn "doas kexec -l /boot/vmlinuz-linux-$KERNEL --initrd=/boot/booster-linux-${KERNEL}.img --reuse-cmdline && doas kexec -e"
$MAP Control       Escape spawn "makoctl dismiss -a"
$MAP Control+Shift      E spawn "emote"
$MAP Control+Alt       Up spawn "$ROTATE normal"
$MAP Control+Alt     Down spawn "$ROTATE 180"
$MAP Control+Alt    Right spawn "$ROTATE 270"
$MAP Control+Alt     Left spawn "$ROTATE 90"

## SCRIPTS
$MAP None          Print spawn "_screenshot select-copy"
$MAP Shift         Print spawn "_screenshot copy"
$MAP Super             c spawn "_clipboard clipman"
$MAP Super+Shift       C spawn "_swayidle_toggle"
$MAP Super+Shift       W spawn "_wifi_toggle"
$MAP Super+Shift       N spawn "_nightlight_toggle"
$MAP Control+Shift Print spawn "_screenrecord"
$MAP Alt+Shift         P spawn "_playwithmpv"

## CONTROLS
$MAP None  XF86AudioRaiseVolume spawn "_volume_change up"
$MAP None  XF86AudioLowerVolume spawn "_volume_change down"
$MAP None         XF86AudioMute spawn "_volume_change mute"
$MAP None   XF86MonBrightnessUp spawn "_brightness_change up"
$MAP None XF86MonBrightnessDown spawn "_brightness_change down"

## BUILT-IN COMMANDS
$MAP Super           Q close
$MAP Super+Shift   End exit
$MAP Super           J focus-view next
$MAP Super           K focus-view previous
$MAP Super+Shift     J swap next
$MAP Super+Shift     K swap previous
$MAP Super      Return zoom
$MAP Super           H send-layout-cmd rivertile "main-ratio -0.05"
$MAP Super           L send-layout-cmd rivertile "main-ratio +0.05"
$MAP Super+Shift     L send-layout-cmd rivertile "main-count +1"
$MAP Super+Shift     H send-layout-cmd rivertile "main-count -1"
$MAP Super+Shift Space toggle-float
$MAP Super           F toggle-fullscreen

# Super+{Up,Right,Down,Left} to change layout orientation
$MAP Super    Up send-layout-cmd rivertile "main-location top"
$MAP Super Right send-layout-cmd rivertile "main-location right"
$MAP Super  Down send-layout-cmd rivertile "main-location bottom"
$MAP Super  Left send-layout-cmd rivertile "main-location left"

## TAGS
$MAP Super 0 set-focused-tags $ALL_TAGS
$MAP Super+Shift 0 set-view-tags $ALL_TAGS
for i in $(seq 1 9)
do
    tags=$((1 << ($i - 1)))

    $MAP Super $i set-focused-tags $tags
    $MAP Super+Shift $i set-view-tags $tags
done

$CMD map-pointer normal Super BTN_RIGHT resize-view
$CMD map-pointer normal Super BTN_LEFT move-view

##########
# SPAWNS #
##########
$SPAWN yambar
$SPAWN "swaybg -i $WALLPAPER"
$SPAWN "mako"
$SPAWN "dbus-daemon --session --address=unix:path=$XDG_RUNTIME_DIR/bus"
#$SPAWN "dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK"
$SPAWN "systemctl --user import-environment"
$SPAWN "doas /usr/bin/powertop --auto-tune"
$SPAWN "hydroxide -disable-carddav -imap-host localhost -smtp-host localhost -debug  serve 2&> /tmp/hydroxide"
#$SPAWN "geary --gapplication-service"
$SPAWN "/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1"
#$SPAWN "emote"
#$SPAWN "_pipewire_start"
$SPAWN "_swayidle_toggle"
$SPAWN "_nightlight_toggle"
$SPAWN "_udiskie_daemon"
$SPAWN "_notify_battery"
$SPAWN "_clipboard watcher"
$SPWAN "signal-desktop-beta --start-in-tray --no-sandbox"

#$SPAWN "$GSET $INTERFACE gtk-theme adw-gtk3-dark"
#$SPAWN "$GSET $INTERFACE icon-theme breeze-dark"
#$SPAWN "$GSET $INTERFACE cursor-theme Adwaita"
#$SPAWN "$GSET $INTERFACE font-name Proxima Nova 11.3"
#$SPAWN "$GSET $INTERFACE enable-animations false"
#$SPAWN "$GSET $INTERFACE color-scheme prefer-dark"
#$SPAWN "$GSET org.gtk.Settings.FileChooser window-size '(740, 371)'"
#$SPAWN "$GSET org.gtk.Settings.FileChooser startup-mode \'cwd\' 
#$SPAWN "$GSET org.gnome.desktop.default-applications.terminal exec $term"
#$SPAWN "$GSET org.gnome.desktop.default-applications.terminal exec-arg ''"

################
# INPUT CONFIG #
################
$INPUT $TOUCHPAD accel-profile adaptive
$INPUT $TOUCHPAD pointer-accel 0.5
$INPUT $TOUCHPAD tap enabled
$INPUT $TOUCHPAD tap-button-map left-right-middle

##################
# CONFIGURATIONS #
##################
for w in ${FLOATS[@]}
do
    $CMD float-filter-add app-id $w
done

$CMD focus-follows-cursor normal
$CMD set-repeat 50 250
$CMD border-color-focused 0xE5E9F0
$CMD border-color-unfocused 0x3B4252
$CMD border-color-urgent 0x88C0D0
$CMD border-width 2

$CMD default-layout rivertile
// exec rivertile -view-padding 2 -main-location top -main-count 2
exec rivertile -view-padding 2