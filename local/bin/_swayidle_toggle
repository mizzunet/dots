#!/usr/bin/bash
# notify_info="Caffine ó°…¶"

PROGRAMS="yay aria2c"

if (pidof swayidle > /dev/null);then 
   echo Unlocked
   killall -9 swayidle
else
   echo Started swayidle
   swayidle -w \
      timeout 30 'if test "$(playerctl status 2>&1)" == "Playing";then exit; else; brillo -O ;brillo -q -u 100000 -U 8;fi' \
      resume  'if test "$(playerctl status 2>&1)" == "Playing";then exit; else; brillo -q -u 100000 -A 8;fi' \
      timeout 60 'if test "$(playerctl status 2>&1)" == "Playing";then exit; else; wlr-randr --output eDP-1 --off;fi' \
      resume 'if test "$(playerctl status 2>&1)" == "Playing";then exit; else wlr-randr --output eDP-1 --on;fi' \
      timeout 180 'if test "$(playerctl status 2>&1)" == "Playing";then exit;fi &&if (pidof $PROGRAMS);then exit; else; loginctl suspend;fi' &
fi
